"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const h=require("./mini.cjs"),l=require("./store.cjs"),p=require("./mini_dom-B4mDRFq5.cjs");function f(n,i,o={nohistory:!1,replacehistory:!0}){n!==l("$url").value&&(i&&l("$args",i),l("$url").value=n||"/",o.nohistory||(o.replacehistory?window.history.pushState({},null,n):window.history.replaceState({},null,n)))}function m(){return l("$route")}async function d({routes:n,loader:i=!1,handleAuth:o}){if(!l("$route")){let r=function(s){s.preventDefault(),s.stopPropagation();const a=window.location.href.replace(window.location.origin,"");f(a)};l("$url",p.reactive(window.location.href.replace(window.location.origin,""))),window.addEventListener("popstate",r)}let t=l("$url").value,e=$(decodeURIComponent(t),n),u=!0;if(!(o&&(u=await o(e),!u)))return e.args=l("$args")||e.args||null,l("$route",e),i?h.Suspense(()=>l("$route").element(e.args),i):()=>p.html`${()=>l("$route").element(e.args)}`}function g(n,i){const o=n.split("/").map((a,c)=>[a.replace(":",""),c,a.charAt(0)===":"]),t=o.filter(([,,a])=>a),e=o.filter(([,,a])=>!a),u=i.split("/"),r=t.map(([a,c])=>[a,u[c]]);let s=!0;return e.forEach(([a,c])=>s=s&a===u[c]),s?Object.fromEntries(r):null}function w(n,i){const o=u=>u.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),t=new RegExp("^"+n.split("*").map(o).join("(.*)")+"$"),e=i.match(t);return e&&e[1]!==null?"/"+e[1]:null}function $(n,i){return R(n,null,i)}function R(n,i,o){let t=n||"/";t&&t!=="/"&&t.slice(-1)==="/"&&(t=t.slice(0,-1));let e=t.split("?")[1];e&&(e=new URLSearchParams(e),e=Object.fromEntries([...e]),t=t.split("?")[0]);const u=o?.find(r=>{if(r.path!=="/"&&r.path.slice(-1)==="/"&&(r.path=r.path.slice(0,-1)),r.path===t||r.path.includes("*")&&(t===r.path.slice(0,-2)?r.subpath="/":r.subpath=w(r.path,t),r.subpath))return!0;if(r.path.includes(":")){const s=g(r.path,t);return s?(r.params=s,!0):!1}return!1});return u?(u.url=t,u.query=e,u):!1}exports.Router=d;exports.getRoute=m;exports.setRoute=f;
