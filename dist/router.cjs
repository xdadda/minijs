"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const h=require("./mini.cjs"),s=require("./store.cjs"),p=require("./mini_dom-az5GXoy1.cjs");function f(n,i={nohistory:!1,replacehistory:!0}){n!==s("$url").value&&(s("$url").value=n||"/",i.nohistory||(i.replacehistory?window.history.pushState({},null,n):window.history.replaceState({},null,n)))}function m(){return s("$route")}async function d({routes:n,loader:i=!1,handleAuth:a}){if(!s("$route")){let o=function(e){e.preventDefault(),e.stopPropagation();const l=window.location.href.replace(window.location.origin,"");f(l,!0)};s("$url",p.reactive(window.location.href.replace(window.location.origin,""))),window.addEventListener("popstate",o)}let t=R(decodeURIComponent(s("$url").value),n),r=!0;if(!(a&&(r=await a(t),!r)))return s("$route",t),i?h.Suspense(()=>s("$route").element(...t.args||[]),i):()=>p.html`${()=>s("$route").element(...t.args||[])}`}function w(n,i){const a=n.split("/").map((u,c)=>[u.replace(":",""),c,u.charAt(0)===":"]),t=a.filter(([,,u])=>u),r=a.filter(([,,u])=>!u),o=i.split("/"),e=t.map(([u,c])=>[u,o[c]]);let l=!0;return r.forEach(([u,c])=>l=l&u===o[c]),l?Object.fromEntries(e):null}function g(n,i){const a=o=>o.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),t=new RegExp("^"+n.split("*").map(a).join("(.*)")+"$"),r=i.match(t);return r&&r[1]!==null?"/"+r[1]:null}function R(n,i){return $(n,null,i)}function $(n,i,a){let t=n||"/";t&&t!=="/"&&t.slice(-1)==="/"&&(t=t.slice(0,-1));let r=t.split("?")[1];r&&(r=new URLSearchParams(r),r=Object.fromEntries([...r]),t=t.split("?")[0]);const o=a?.find(e=>{if(e.path!=="/"&&e.path.slice(-1)==="/"&&(e.path=e.path.slice(0,-1)),e.path===t||e.path.includes("*")&&(t===e.path.slice(0,-2)?e.subpath="/":e.subpath=g(e.path,t),e.subpath))return!0;if(e.path.includes(":")){const l=w(e.path,t);return l?(e.params=l,!0):!1}return!1});return o?(o.url=t,o.query=r,o):!1}exports.Router=d;exports.getRoute=m;exports.setRoute=f;
